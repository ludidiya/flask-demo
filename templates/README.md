# 模板

我们把包含变量和运算逻辑的 HTML 或其他格式的文本叫做模板，执行这些变量替换和逻辑计算工作的过程被称为渲染，这个工作由模板渲染引擎——Jinja2来完成。

inja2 的语法和 Python 大致相同。在模板里，需要添加特定的定界符将 Jinja2 语句和变量标记出来，下面是三种常用的定界符：

* `{{ ... }}` 用来标记变量。
* `{% ... %}` 用来标记语句，比如 if 语句，for 语句等。
* `{# ... #}` 用来写注释。

**过滤器**

为了方便对变量进行处理，Jinja2 提供了一些过滤器，语法形式如下：

```{{ 变量|过滤器 }}```

左侧是变量，右侧是过滤器名。比如，使用 length 过滤器来获取字符串的长度，类似 Python 里的 len() 函数。

[点击查看Jinja所有可用过滤器](https://jinja.palletsprojects.com/en/2.10.x/templates/#list-of-builtin-filters)

## 404 错误页面

404 错误页面模板

## 使用模板继承组织模板

对于模板内容重复的问题，Jinja2 提供了模板继承的支持。这个机制和 Python 类继承非常类似：我们可以定义一个父模板，一般会称之为基模板（base template）。基模板中包含完整的 HTML 结构和导航栏、页首、页脚都通用部分。在子模板里，我们可以使用 extends 标签来声明继承自某个基模板。
基模板（`templates/base.html`）中需要在实际的子模板中追加或重写的部分则可以定义成块（block）。块使用 block 标签创建， `或` 作为结束标记。通过在子模板里定义一个同样名称的块，你可以向基模板的对应块位置追加或重写内容。

在基模板里添加了两个块，一个是包含 `<head></head>` 内容的 `head` 块，另一个是用来在子模板中插入页面主体内容的 `content` 块。在复杂的项目里，可以定义更多的块，方便在子模板中对基模板的各个部分插入内容。另外，块的名字没有特定要求，可以自由修改。

在`index.html`第一行使用 `extends` 标签声明扩展自模板 `base.html`，可以理解成这个模板继承自 `base.html`。接着我们定义了 content 块，这里的内容会插入到基模板中 content 块的位置。

>**提示** 默认的块重写行为是覆盖，如果你想向父块里追加内容，可以在子块中使用 `super()` 声明，即 `{{ super() }}`。

## 表单

编写表单的 HTML 代码有下面几点需要注意：

* 在 `<form>` 标签里使用 `method` 属性将提交表单数据的 `HTTP` 请求方法指定为 `POST`。如果不指定，则会默认使用 `GET` 方法，这会将表单数据通过 URL 提交，容易导致数据泄露，而且不适用于包含大量数据的情况。

* `<input>` 元素必须要指定 `name`  属性，否则无法提交数据，在服务器端，我们也需要通过这个 `name` 属性值来获取对应字段的数据。

> **提示** 填写输入框标签文字的 `<label>` 元素不是必须的，只是为了辅助鼠标用户。当使用鼠标点击标签文字时，会自动激活对应的输入框，这对复选框来说比较有用。for 属性填入要绑定的 `<input>` 元素的 id 属性值。

### 处理表单数据

默认情况下，当表单中的提交按钮被按下，浏览器会创建一个新的请求，默认发往当前 URL（在 `<form>` 元素使用 action 属性可以自定义目标 URL）。

因为我们在模板里为表单定义了 POST 方法，当你输入数据，按下提交按钮，一个携带输入信息的 POST 请求会发往根地址。接着，你会看到一个 405 Method Not Allowed 错误提示。***这是因为处理根地址请求的 index 视图默认只接受 GET 请求。***

> **提示** 在 HTTP 中，GET 和 POST 是两种最常见的请求方法，其中 GET 请求用来获取资源，而 POST 则用来创建 / 更新资源。我们访问一个链接时会发送 GET 请求，而提交表单通常会发送 POST 请求。

为了能够处理 POST 请求，我们需要修改一下视图函数：

```python
@app.route('/', methods=['GET', 'POST'])
```

在 `app.route()` 装饰器里，我们可以用 methods 关键字传递一个包含 HTTP 方法字符串的列表，表示这个视图函数处理哪种方法类型的请求。默认只接受 GET 请求，上面的写法表示同时接受 GET 和 POST 请求。

两种方法的请求有不同的处理逻辑：对于 GET 请求，返回渲染后的页面；对于 POST 请求，则获取提交的表单数据并保存。

为了在函数内加以区分，我们添加一个 if 判断：
